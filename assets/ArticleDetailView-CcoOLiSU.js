import{_ as B,l as H,r as b,m as T,o as S,w as p,c as i,d as c,f as D,b as v,j as o,t as d,k as g,F as I,e as N,n as q,p as F,h as n,i as V,q as C}from"./index-Cr5NmYDi.js";import{E as j}from"./el-empty-Dj6z8Y15.js";import{E as P}from"./el-skeleton-item-kUQYQMpp.js";import{M as R,i as G,m as J,P as O}from"./PageHeader-CCFVggbO.js";import"./index-CewPtJvU.js";import"./_commonjsHelpers-CqkleIqs.js";const z={class:"article-detail-wrapper"},K={key:0,class:"loading-container"},Q={key:1},W={key:0,class:"article-detail-card"},$={class:"article-body"},U={key:0,class:"title-without-cover"},X={class:"meta-tags"},Y={class:"meta-tag tag-date"},Z={class:"meta-tag tag-words"},ee={key:0,class:"meta-tag tag-category"},te=["innerHTML"],ae={key:2,class:"comment-section"},se={__name:"ArticleDetailView",props:{id:{type:String,required:!0}},setup(x){const y=x,h=H(),a=b(null),u=b(!0),_=T(()=>!u.value&&a.value&&a.value.id),m=new R({html:!0,linkify:!0,breaks:!0,highlight:function(s){return'<pre class="code-block"><code>'+m.utils.escapeHtml(s)+"</code></pre>"}});m.use(G),m.use(J);const k=T(()=>a.value&&a.value.contentMd?m.render(a.value.contentMd):""),M=()=>{C(()=>{document.querySelectorAll(".markdown-content pre.code-block").forEach(e=>{if(e.querySelector(".copy-code-btn"))return;const t=document.createElement("button");t.className="copy-code-btn",t.innerHTML='<i class="fa-regular fa-copy"></i> 复制',t.addEventListener("click",()=>{const f=e.querySelector("code").innerText,r=document.createElement("textarea");r.value=f,r.style.position="fixed",r.style.left="-9999px",document.body.appendChild(r),r.select();let l=!1;try{l=document.execCommand("copy")}catch(E){console.error("Fallback copy failed:",E)}document.body.removeChild(r),l?(t.innerHTML='<i class="fa-solid fa-check"></i> 已复制',setTimeout(()=>{t.innerHTML='<i class="fa-regular fa-copy"></i> 复制'},2e3)):(t.innerHTML='<i class="fa-solid fa-exclamation-triangle"></i> 复制失败',setTimeout(()=>{t.innerHTML='<i class="fa-regular fa-copy"></i> 复制'},2e3))}),e.style.position="relative",e.appendChild(t)})})},A=()=>{const s=document.getElementById("giscus-container");if(!s)return;s.innerHTML="";const e=h.theme==="light"?"light":"dark",t=document.createElement("script");t.src="https://giscus.app/client.js",t.setAttribute("data-theme",e),t.setAttribute("data-repo","SelfLo06/blog-comments"),t.setAttribute("data-repo-id","R_kgDOPJ9FjQ"),t.setAttribute("data-category","Blog Comments"),t.setAttribute("data-category-id","DIC_kwDOPJ9Fjc4Csv-9"),t.setAttribute("data-mapping","pathname"),t.setAttribute("data-lang","zh-CN"),t.setAttribute("crossorigin","anonymous"),t.async=!0,s.appendChild(t)},w=async s=>{u.value=!0,a.value=null;try{const e=await q(s);e.code===0&&e.data?e.data.status===0?(a.value=e.data,document.title=`${a.value.title} - selflo's Blog`):console.warn("尝试访问一篇草稿文章，已阻止渲染。"):console.error("获取文章详情失败:",e.message)}catch(e){console.error("请求文章详情时发生网络错误:",e)}finally{u.value=!1}},L=s=>s?s.split("T")[0]:"";return S(()=>{w(y.id)}),p(()=>y.id,s=>{s&&w(s)}),p(k,s=>{s&&M()}),p(_,s=>{s&&C(()=>{A()})}),p(()=>h.theme,s=>{const e=document.querySelector("iframe.giscus-frame");if(!e)return;const t=s==="light"?"light":"dark";e.contentWindow.postMessage({giscus:{setConfig:{theme:t}}},"https://giscus.app")}),(s,e)=>{const t=P,f=F("RouterLink"),r=j;return n(),i("div",z,[u.value?(n(),i("div",K,[D(t,{rows:10,animated:""})])):(n(),i("div",Q,[a.value&&a.value.id?(n(),i("div",W,[a.value.coverImage?(n(),v(O,{key:0,title:a.value.title,"cover-image":a.value.coverImage},null,8,["title","cover-image"])):c("",!0),o("div",$,[a.value.coverImage?c("",!0):(n(),i("h1",U,d(a.value.title),1)),o("div",X,[o("span",Y,[e[0]||(e[0]=o("i",{class:"fa-regular fa-calendar-days"},null,-1)),g(" "+d(L(a.value.createTime)),1)]),o("span",Z,[e[1]||(e[1]=o("i",{class:"fa-solid fa-pencil"},null,-1)),g(" 约 "+d(a.value.wordCount)+" 字 ",1)]),a.value.categoryName?(n(),i("span",ee,[e[2]||(e[2]=o("i",{class:"fa-regular fa-folder"},null,-1)),g(" "+d(a.value.categoryName),1)])):c("",!0),a.value.tags&&a.value.tags.length>0?(n(!0),i(I,{key:1},N(a.value.tags,l=>(n(),v(f,{key:l.id,to:{name:"tag-search",query:{tagIds:l.id}},class:"meta-tag tag-item"},{default:V(()=>[e[3]||(e[3]=o("i",{class:"fa-solid fa-tag"},null,-1)),g(" "+d(l.name),1)]),_:2,__:[3]},1032,["to"]))),128)):c("",!0)]),o("div",{class:"markdown-content",innerHTML:k.value},null,8,te)])])):(n(),v(r,{key:1,description:"文章不存在或已被删除"}))])),_.value?(n(),i("div",ae,e[4]||(e[4]=[o("div",{class:"divider"},null,-1),o("div",{id:"giscus-container",class:"giscus-wrapper"},null,-1)]))):c("",!0)])}}},de=B(se,[["__scopeId","data-v-10d35b54"]]);export{de as default};
