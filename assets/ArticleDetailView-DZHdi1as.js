import{_ as B,l as S,r as C,m as T,o as D,w as p,c as l,d as c,f as I,b as h,j as o,t as u,k as g,F as N,e as j,n as q,u as F,p as V,q as P,h as r,i as J,s as b}from"./index-cqugP81o.js";import{E as R}from"./el-empty-DVA1fN4J.js";import{E as z}from"./el-skeleton-item-Bl_bM89L.js";import{M as G,i as O,m as K,P as Q,H as x}from"./index-41WDKi-Y.js";import"./index-DIOsHTaz.js";import"./_commonjsHelpers-CqkleIqs.js";const W={class:"article-detail-wrapper"},$={key:0,class:"loading-container"},U={key:1},X={key:0,class:"article-detail-card"},Y={class:"article-body"},Z={key:0,class:"title-without-cover"},ee={class:"meta-tags"},te={class:"meta-tag tag-date"},ae={class:"meta-tag tag-words"},se={key:0,class:"meta-tag tag-category"},oe=["innerHTML"],re={key:2,class:"comment-section"},ne={__name:"ArticleDetailView",props:{id:{type:String,required:!0}},setup(L){const y=L,f=S(),a=C(null),d=C(!0),_=T(()=>!d.value&&a.value&&a.value.id),m=new G({html:!0,linkify:!0,breaks:!0,highlight:function(s,e){if(e&&x.getLanguage(e))try{return'<pre class="hljs"><code>'+x.highlight(s,{language:e,ignoreIllegals:!0}).value+"</code></pre>"}catch(t){console.warn("代码高亮失败:",t)}return'<pre class="hljs"><code>'+m.utils.escapeHtml(s)+"</code></pre>"}});m.use(O),m.use(K);const k=T(()=>a.value&&a.value.contentMd?m.render(a.value.contentMd):""),M=()=>{b(()=>{document.querySelectorAll(".markdown-content pre.hljs").forEach(e=>{if(e.querySelector(".copy-code-btn"))return;const t=document.createElement("button");t.className="copy-code-btn",t.innerHTML='<i class="fa-regular fa-copy"></i> 复制',t.addEventListener("click",()=>{const v=e.querySelector("code").innerText,n=document.createElement("textarea");n.value=v,n.style.position="fixed",n.style.left="-9999px",document.body.appendChild(n),n.select();let i=!1;try{i=document.execCommand("copy")}catch(H){console.error("Fallback copy failed:",H)}document.body.removeChild(n),i?(t.innerHTML='<i class="fa-solid fa-check"></i> 已复制',setTimeout(()=>{t.innerHTML='<i class="fa-regular fa-copy"></i> 复制'},2e3)):(t.innerHTML='<i class="fa-solid fa-exclamation-triangle"></i> 复制失败',setTimeout(()=>{t.innerHTML='<i class="fa-regular fa-copy"></i> 复制'},2e3))}),e.style.position="relative",e.appendChild(t)})})},A=()=>{const s=document.getElementById("giscus-container");if(!s)return;s.innerHTML="";const e=f.theme==="light"?"light":"dark",t=document.createElement("script");t.src="https://giscus.app/client.js",t.setAttribute("data-theme",e),t.setAttribute("data-repo","SelfLo06/blog-comments"),t.setAttribute("data-repo-id","R_kgDOPJ9FjQ"),t.setAttribute("data-category","Blog Comments"),t.setAttribute("data-category-id","DIC_kwDOPJ9Fjc4Csv-9"),t.setAttribute("data-mapping","pathname"),t.setAttribute("data-lang","zh-CN"),t.setAttribute("crossorigin","anonymous"),t.async=!0,s.appendChild(t)},w=async s=>{d.value=!0,a.value=null;try{const e=await V(s);e.code===0&&e.data?e.data.status===0?(a.value=e.data,document.title=`${a.value.title} - selflo's Blog`):console.warn("尝试访问一篇草稿文章，已阻止渲染。"):console.error("获取文章详情失败:",e.message)}catch(e){console.error("请求文章详情时发生网络错误:",e)}finally{d.value=!1}},E=s=>s?s.split("T")[0]:"";return D(()=>{w(y.id)}),p(()=>y.id,s=>{s&&w(s)}),p(k,s=>{s&&M()}),p(_,s=>{s&&b(()=>{A()})}),p(()=>f.theme,s=>{const e=document.querySelector("iframe.giscus-frame");if(!e)return;const t=s==="light"?"light":"dark";e.contentWindow.postMessage({giscus:{setConfig:{theme:t}}},"https://giscus.app")}),(s,e)=>{const t=z,v=P("RouterLink"),n=R;return r(),l("div",W,[d.value?(r(),l("div",$,[I(t,{rows:10,animated:""})])):(r(),l("div",U,[a.value&&a.value.id?(r(),l("div",X,[a.value.coverImage?(r(),h(Q,{key:0,title:a.value.title,"cover-image":a.value.coverImage},null,8,["title","cover-image"])):c("",!0),o("div",Y,[a.value.coverImage?c("",!0):(r(),l("h1",Z,u(a.value.title),1)),o("div",ee,[o("span",te,[e[0]||(e[0]=o("i",{class:"fa-regular fa-calendar-days"},null,-1)),g(" "+u(E(a.value.createTime)),1)]),o("span",ae,[e[1]||(e[1]=o("i",{class:"fa-solid fa-pencil"},null,-1)),g(" 约 "+u(a.value.wordCount)+" 字 ",1)]),a.value.categoryName?(r(),l("span",se,[e[2]||(e[2]=o("i",{class:"fa-regular fa-folder"},null,-1)),g(" "+u(a.value.categoryName),1)])):c("",!0),a.value.tags&&a.value.tags.length>0?(r(!0),l(N,{key:1},j(a.value.tags,i=>(r(),h(v,{key:i.id,to:{name:"tag-search",query:{tagIds:i.id}},class:"meta-tag tag-item"},{default:J(()=>[e[3]||(e[3]=o("i",{class:"fa-solid fa-tag"},null,-1)),g(" "+u(i.name),1)]),_:2,__:[3]},1032,["to"]))),128)):c("",!0)]),o("div",{class:q(["markdown-content",{"dark-theme":F(f).theme==="dark"}]),innerHTML:k.value},null,10,oe)])])):(r(),h(n,{key:1,description:"文章不存在或已被删除"}))])),_.value?(r(),l("div",re,e[4]||(e[4]=[o("div",{class:"divider"},null,-1),o("div",{id:"giscus-container",class:"giscus-wrapper"},null,-1)]))):c("",!0)])}}},pe=B(ne,[["__scopeId","data-v-a756bf26"]]);export{pe as default};
