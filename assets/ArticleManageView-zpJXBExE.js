import{_ as F,r as _,Z as K,o as O,c,l as g,a as R,g as a,k as s,$ as Z,D as f,L as q,j as r,m as d,F as E,d as V,t as S}from"./index-DtCQP6yO.js";import{v as G}from"./el-loading-Cqiw-YA5.js";import{a as H,E as J,b as Q,c as W}from"./el-select-CusOx3_Y.js";import{E as X}from"./el-input-DyIGY9WC.js";import{E as h,a as Y,b as ee,c as te,d as ae}from"./el-button-DuEFWLIT.js";import{g as le,a as oe,d as se}from"./admin-DPEjzm7h.js";import"./index-C2X26IaE.js";const ne={class:"article-manage-view"},re={class:"table-header"},ie={class:"table-filters"},de={key:0},ue={key:1},pe={class:"pagination-container"},ce={__name:"ArticleManageView",setup(ge){const b=q(),w=_([]),y=_(!0),o=_({page:1,pageSize:10,total:0}),k=_([]),n=K({keyword:"",categoryId:"",status:""}),u=async()=>{y.value=!0;try{const l={page:o.value.pageNum,pageSize:o.value.pageSize,title:n.keyword,categoryId:n.categoryId,status:n.status},e=await le(l);w.value=e.data.records,o.value.total=e.data.total,o.value.page=e.data.current}catch(l){console.error("获取文章列表失败:",l),h.error("数据加载失败，请稍后再试")}finally{y.value=!1}},I=async()=>{try{const l=await oe();k.value=l.data}catch(l){console.error("获取分类选项失败:",l)}};O(()=>{u(),I()});const B=()=>{b.push({name:"article-publish"})},T=l=>{b.push({name:"article-edit",params:{id:l}})},A=async l=>{try{await ae.confirm("确定要删除这篇文章吗？此操作不可逆！","警告",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}),await se(l),h.success("删除成功"),u()}catch(e){e!=="cancel"&&h.error("删除失败")}},C=()=>{o.value.page=1,u()},D=()=>{n.keyword="",n.categoryId="",n.status="",o.value.page=1,u()},M=l=>{o.value.pageSize=l,u()},N=l=>{o.value.page=l,u()},U=l=>l===0?"已发布":"草稿";return(l,e)=>{const p=Y,L=X,v=Q,x=H,i=te,z=W,P=ee,$=J,j=G;return r(),c("div",ne,[g("div",re,[e[6]||(e[6]=g("h1",null,"文章管理",-1)),a(p,{type:"primary",onClick:B},{default:s(()=>e[5]||(e[5]=[g("i",{class:"fa-solid fa-plus",style:{"margin-right":"8px"}},null,-1),d(" 发布新文章 ")])),_:1,__:[5]})]),g("div",ie,[a(L,{modelValue:n.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>n.keyword=t),placeholder:"请输入标题关键词",onKeyup:Z(C,["enter"]),clearable:"",style:{width:"240px"}},null,8,["modelValue"]),a(x,{modelValue:n.categoryId,"onUpdate:modelValue":e[1]||(e[1]=t=>n.categoryId=t),placeholder:"按分类筛选",clearable:"",style:{width:"180px"}},{default:s(()=>[(r(!0),c(E,null,V(k.value,t=>(r(),f(v,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(x,{modelValue:n.status,"onUpdate:modelValue":e[2]||(e[2]=t=>n.status=t),placeholder:"按状态筛选",clearable:"",style:{width:"120px"}},{default:s(()=>[a(v,{label:"已发布",value:0}),a(v,{label:"草稿",value:1})]),_:1},8,["modelValue"]),a(p,{type:"primary",onClick:C},{default:s(()=>e[7]||(e[7]=[d("搜索")])),_:1,__:[7]}),a(p,{onClick:D},{default:s(()=>e[8]||(e[8]=[d("重置")])),_:1,__:[8]})]),R((r(),f(P,{data:w.value,style:{width:"100%"}},{default:s(()=>[a(i,{prop:"id",label:"ID",width:"80"}),a(i,{prop:"title",label:"文章标题","show-overflow-tooltip":""}),a(i,{label:"标签",width:"200"},{default:s(({row:t})=>[t.tags&&t.tags.length?(r(),c("div",de,[(r(!0),c(E,null,V(t.tags,m=>(r(),f(z,{key:m.id,size:"small",style:{"margin-right":"5px","margin-bottom":"5px"}},{default:s(()=>[d(S(m.name),1)]),_:2},1024))),128))])):(r(),c("span",ue,"-"))]),_:1}),a(i,{prop:"categoryName",label:"分类",width:"120"}),a(i,{prop:"status",label:"状态",width:"100"},{default:s(({row:t})=>[a(z,{type:t.status===0?"success":"info"},{default:s(()=>[d(S(U(t.status)),1)]),_:2},1032,["type"])]),_:1}),a(i,{prop:"updateTime",label:"更新时间",width:"180"}),a(i,{label:"操作",width:"150",fixed:"right"},{default:s(({row:t})=>[a(p,{link:"",type:"primary",size:"small",onClick:m=>T(t.id)},{default:s(()=>e[9]||(e[9]=[d("编辑")])),_:2,__:[9]},1032,["onClick"]),a(p,{link:"",type:"danger",size:"small",onClick:m=>A(t.id)},{default:s(()=>e[10]||(e[10]=[d("删除")])),_:2,__:[10]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[j,y.value]]),g("div",pe,[a($,{background:"",layout:"total, sizes, prev, pager, next, jumper",total:o.value.total,"current-page":o.value.page,"onUpdate:currentPage":e[3]||(e[3]=t=>o.value.page=t),"page-size":o.value.pageSize,"onUpdate:pageSize":e[4]||(e[4]=t=>o.value.pageSize=t),onSizeChange:M,onCurrentChange:N},null,8,["total","current-page","page-size"])])])}}},we=F(ce,[["__scopeId","data-v-f7102f74"]]);export{we as default};
